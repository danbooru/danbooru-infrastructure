# https://kubectl.docs.kubernetes.io/references/kustomize/kustomization/secretgenerator/
# https://kubectl.docs.kubernetes.io/references/kustomize/kustomization/configmapgenerator/#configmap-from-env-file

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

configMapGenerator:
# The danbooru.donmai.us nginx config
- name: danbooru-nginx-config
  namespace: danbooru
  files:
  - config/danbooru/nginx.conf

# The Downbooru nginx config for maintenance mode
- name: downbooru-nginx-config
  namespace: danbooru
  files:
  - config/downbooru/nginx.conf

# The betabooru.donmai.us .env config
- name: betabooru-config-env
  namespace: danbooru
  env: config/betabooru.env

# The danbooru.donmai.us .env config
- name: danbooru-config-env
  namespace: danbooru
  env: config/danbooru.env

- name: recommender-config-env
  namespace: danbooru
  env: config/recommender.env

- name: postgres-config
  namespace: danbooru
  files:
  - config/postgres/postgresql.conf
  - config/postgres/pg_hba.conf

- name: redis-config
  namespace: danbooru
  files:
  - config/redis/redis.conf

resources:
- namespaces.yaml
- danbooru.yaml
- danbooru-cron.yaml
- danbooru-jobs.yaml
- betabooru.yaml
- downbooru.yaml
- postgres.yaml
- redis.yaml
- recommender.yaml
- iqdb.yaml
- fumimi.yaml
